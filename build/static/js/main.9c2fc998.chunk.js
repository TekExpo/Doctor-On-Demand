(this.webpackJsonpacs_calling_sample=this.webpackJsonpacs_calling_sample||[]).push([[0],{181:function(e,t,n){e.exports=n.p+"static/media/hero.4acf60cc.svg"},209:function(e,t,n){e.exports=n(343)},214:function(e,t,n){},341:function(e){e.exports=JSON.parse('{"name":"acs_calling_sample","version":"0.3.0","private":true,"description":"This is a sample application to show how the ACS Calling Web SDK can be used to build a group calling experience. The client-side application is a React based user interface which uses Redux for handling complex state while leveraging Microsoft Fluent UI for how things look. Powering this front-end is a C# web application powered by ASP.net Core to connect this application with Azure.","dependencies":{"@azure/communication-calling":"1.0.0-beta.1","@azure/communication-common":"1.0.0-beta.1","@fluentui/react":"^7.117.1","@fluentui/react-icons-northstar":"^0.51.0","@fluentui/react-northstar":"^0.51.0","@types/preval.macro":"^3.0.0","@types/react":"^16.9.49","@types/react-dom":"^16.9.8","@types/react-redux":"^7.1.9","@types/uuid":"^8.3.0","bootstrap":"^4.1.3","jquery":"^3.5.1","merge":"^1.2.1","oidc-client":"^1.9.0","preval.macro":"^5.0.0","react":"^16.8.0","react-dom":"^16.8.0","react-redux":"^7.2.0","react-router-bootstrap":"^0.25.0","react-router-dom":"^5.1.2","react-scripts":"^3.4.3","reactstrap":"^8.4.1","redux":"^4.0.5","redux-thunk":"^2.3.0","rimraf":"^2.6.2","source-map-explorer":"^2.5.0","uuid":"^8.1.0"},"devDependencies":{"ajv":"^6.9.1","cross-env":"^5.2.0","typescript":"^3.7.5","eslint":"^6.8.0","eslint-config-react-app":"^5.2.0","eslint-plugin-flowtype":"^4.6.0","eslint-plugin-import":"^2.20.1","eslint-plugin-jsx-a11y":"^6.2.3","eslint-plugin-react":"^7.18.3","nan":"^2.14.1","prettier":"2.0.5"},"eslintConfig":{"extends":"react-app"},"scripts":{"analyze":"source-map-explorer \'build/static/js/*.js\'","start":"rimraf ./build && react-scripts start","build":"react-scripts build","test":"cross-env CI=true react-scripts test --env=jsdom","eject":"react-scripts eject","prettier":"prettier --write --config .prettierrc **/*.js **/*.ts","prettier:check":"prettier --check --config .prettierrc **/*.js **/*.ts","lint":"eslint */**/*.{ts,tsx} && echo Lint completed.","lint:quiet":"eslint */**/*.{ts,tsx} --quiet && echo Lint completed."},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"proxy":"http://localhost:7071"}')},343:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(55),o=n.n(c),s=(n(214),n(19)),l=n(30),d=n(403),m=n(412),u=n(409),p=n(179),h=n(414),f=n(22),v=n(410),g=n(385),b=n(386),S=n(387),E=n(388),I=n(389),O=n(390),D=n(391),j=n(4),C=Object(j.y)().palette,y=Object(j.D)({height:"3.75rem",padding:"0 0.8125rem",display:"inline-block",borderRadius:7,overflow:"hidden"}),w=Object(j.D)({backgroundColor:C.white,width:"2rem",height:"3.75rem",border:"0.125rem",borderRadius:2,marginRight:"0.4375rem",color:C.neutralSecondary}),x=Object(j.D)(w,{color:C.neutralLight}),N=Object(j.D)({backgroundColor:"#d74654",width:"6.5625rem",height:"2.1875rem",border:"0.125rem",marginRight:"0.75rem",marginLeft:"0.75rem",borderRadius:2,color:C.white,selectors:{":focus":{color:C.white},":hover":{color:C.white},":active":{color:C.white}}}),A=Object(j.D)({color:C.white,padding:"0.3125rem",fontSize:"0.875rem",lineHeight:"3.75rem"}),k=Object(j.D)({width:"100%"}),L=function(e){var t="Denied"!==e.cameraPermission&&e.cameraActive,n="Denied"===e.cameraPermission,a="Denied"!==e.cameraPermission?e.onCameraChange:void 0,i="Denied"!==e.microphonePermission&&e.micActive,c="Denied"===e.microphonePermission,o="Denied"!==e.microphonePermission?e.onMicChange:void 0,s=!!e.activeScreenShareStream;return r.createElement(d.a,{className:y},r.createElement(v.a,{onKeyDownCapture:function(t){13===t.keyCode&&e.localVideoRendererIsBusy&&t.preventDefault()},disabled:n,onClick:a,className:w},r.createElement("div",{className:k},t?r.createElement(g.a,{size:"medium"}):r.createElement(b.a,{size:"medium"}))),r.createElement(v.a,{onClick:o,disabled:c,className:w},r.createElement("div",{className:k},i?r.createElement(S.a,{size:"medium"}):r.createElement(E.a,{size:"medium"}))),e.isLocalScreenShareSupportedInBrowser()&&r.createElement(v.a,{disabled:s,onClick:e.onScreenShareChange,className:s?x:w},r.createElement("div",{className:k},e.screenShareActive?r.createElement(I.a,{size:"medium"}):r.createElement(O.a,{size:"medium"}))),r.createElement(v.a,{onClick:e.onEndCallClick,className:e.compressedMode?w:N},r.createElement("div",{className:k},r.createElement(D.a,{size:"medium"}),!e.compressedMode&&r.createElement("span",{className:A},"Leave"))))},P=n(401),R={childrenGap:"1.5rem"},_={childrenGap:"0.75rem"},V={caretDownWrapper:{height:"2.5rem",lineHeight:"2.5rem"},dropdownItem:{fontWeight:600,fontSize:"0.875rem",height:"2.5rem"},dropdown:{height:"2.5rem"},title:{fontWeight:600,fontSize:"0.875rem",height:"2.5rem",lineHeight:"2.3125rem"},label:{fontWeight:600,fontSize:"0.875rem"}},T=Object(j.D)({width:"100%",maxWidth:"18.75rem",minWidth:"12.5rem",maxHeight:"14.125rem",marginTop:"2.125rem"}),M=function(e){var t=function(e){return e.map((function(e){return{val:e,key:e.id,text:""===e.name?e.deviceType:e.name}}))};return i.a.createElement(d.a,{className:T,tokens:R},i.a.createElement(P.a,{placeholder:"Select an option",label:"Camera",options:t(e.videoDeviceList),styles:V,disabled:0===e.videoDeviceList.length,defaultSelectedKey:e.videoDeviceInfo?e.videoDeviceInfo.id:"",onChange:function(){var t,n=null!==(t=arguments.length<=2?void 0:arguments[2])&&void 0!==t?t:0;e.setVideoDeviceInfo(e.videoDeviceList[n])}}),i.a.createElement(d.a,{tokens:_},i.a.createElement(P.a,{placeholder:"Select an option",label:"Microphone",styles:V,disabled:0===e.audioDeviceList.length,options:t(e.audioDeviceList),defaultSelectedKey:e.audioDeviceInfo?e.audioDeviceInfo.id:"",onChange:function(){var t,n=null!==(t=arguments.length<=2?void 0:arguments[2])&&void 0!==t?t:0;e.setAudioDeviceInfo(e.audioDeviceList[n])}})))},z=n(45),W=n(5),G=n.n(W),F=n(15),H=n(404),U=n(392),B={getAppServiceUrl:function(){return window.location.origin},getTokenForUser:function(){var e=Object(F.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/getUserToken?userId=".concat(encodeURIComponent(t)));case 2:if(!(n=e.sent).ok){e.next=5;break}return e.abrupt("return",n.json());case 5:throw new Error("Invalid token response");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getGroupID:function(){var e=Object(F.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/getGroupId");case 2:if(!(t=e.sent).ok){e.next=5;break}return e.abrupt("return",t.text());case 5:throw new Error("Invalid token response");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isSelectedAudioDeviceInList:function(e,t){return t.filter((function(t){return t.name===e.name})).length>0},isSelectedVideoDeviceInList:function(e,t){return t.filter((function(t){return t.name===e.name})).length>0},isMobileSession:function(){return!!window.navigator.userAgent.match(/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone)/g)},isSmallScreen:function(){return window.innerWidth<700||window.innerHeight<400},getId:function(e){return Object(U.b)(e)?e.communicationUserId:Object(U.a)(e)?e.callingApplicationId:Object(U.c)(e)?e.phoneNumber:e.id},getStreamId:function(e,t){var n=t.id;return"".concat(e,"-").concat(n,"-").concat(t.type)},isOnIphoneAndNotSafari:function(){var e=navigator.userAgent;return!(!e.includes("iPhone")||!e.includes("FxiOS")&&!e.includes("CriOS"))},getBuildTime:function(){return"9/26/2020, 15:00:49"}},K=function(e){return{type:"SET_CALL_AGENT",callAgent:e}},Y=function(e){return{type:"CALL_ADDED",call:e}},q=function(e,t){return{type:"CALL_REMOVED",call:void 0,incomingCallEndReason:e.isIncoming?e.callEndReason:void 0,groupCallEndReason:!e.isIncoming&&t?e.callEndReason:void 0}},J=function(e){return{type:"SET_CALL_STATE",callState:e}},Q=function(e){return{type:"SET_PARTICIPANTS",remoteParticipants:e}},X=function(e){return{type:"SET_MIC",mic:e}},Z=function(e){return{type:"SET_SHARE_SCREEN",shareScreen:e}},$=function(e){return{type:"SET_DEVICE_MANAGER",deviceManager:e}},ee=function(e){return{type:"SET_MICROPHONE_PERMISSION",microphonePermission:e}},te=function(e){return{type:"SET_CAMERA_PERMISSION",cameraPermission:e}},ne=function(e){return{type:"SET_AUDIO_DEVICE_INFO",audioDeviceInfo:e}},ae=function(e){return{type:"SET_VIDEO_DEVICE_INFO",videoDeviceInfo:e}},re=function(e){return{type:"SET_AUDIO_DEVICE_LIST",audioDeviceList:e}},ie=function(e){return{type:"SET_VIDEO_DEVICE_LIST",videoDeviceList:e}},ce=function(e){return{type:"SET_LOCAL_STREAM",localVideoStream:e}},oe=function(e,t){return{type:"ADD_SCREENSHARE_STREAM",stream:e,user:t}},se=function(e){return function(){var t=Object(F.a)(G.a.mark((function t(n,a){var r;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=a())&&void 0!==r.calls.call){t.next=4;break}return console.error("state or state.controls.mic is null"),t.abrupt("return");case 4:if(t.prev=4,r.controls.mic){t.next=10;break}return t.next=8,r.calls.call.unmute();case 8:t.next=12;break;case 10:return t.next=12,r.calls.call.mute();case 12:n(X(e)),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(e,n){return t.apply(this,arguments)}}()},le=function(){var e=Object(F.a)(G.a.mark((function e(t,n){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.hangUp(n).catch((function(e){return console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=Object(F.a)(G.a.mark((function e(t,n,a){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.join(n,a);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.log("Failed to join a call",e.t0),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,a){return e.apply(this,arguments)}}(),me=function(){var e=Object(F.a)(G.a.mark((function e(t,n){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.removeParticipant(n).catch((function(e){return console.error(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ue=function(e,t,n,a){var r=B.getId(e.identifier);e.on("participantStateChanged",(function(){console.log("participant stateChanged",r,e.state),n(Q(Object(z.a)(t.remoteParticipants.values())))})),e.on("isSpeakingChanged",(function(){n(Q(Object(z.a)(t.remoteParticipants.values())))})),e.on("videoStreamsUpdated",(function(t){t.added.forEach((function(t){"Video"!==t.type&&(t.on("availabilityChanged",(function(){t.isAvailable?n(oe(t,e)):n({type:"REMOVE_SCREENSHARE_STREAM",stream:t,user:e})})),t.isAvailable&&n(oe(t,e)))}))}))},pe=function(){var e=Object(F.a)(G.a.mark((function e(t,n,a){var r,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMicrophoneList();case 2:r=e.sent,n(re(r)),void 0===(i=a()).devices.audioDeviceInfo&&r.length>0?(n(ne(r[0])),t.setMicrophone(r[0])):i.devices.audioDeviceInfo&&!B.isSelectedAudioDeviceInList(i.devices.audioDeviceInfo,r)&&t.setMicrophone(i.devices.audioDeviceInfo);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),he=function(){var e=Object(F.a)(G.a.mark((function e(t,n,a){var r,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.getCameraList(),n(ie(r)),void 0===(i=a()).devices.videoDeviceInfo?n(ae(r[0])):i.devices.videoDeviceInfo&&!B.isSelectedVideoDeviceInList(i.devices.videoDeviceInfo,r)&&n(ae(i.devices.videoDeviceInfo));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),fe=function(){var e=Object(F.a)(G.a.mark((function e(t,n,a){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("permissionStateChanged",Object(F.a)(G.a.mark((function e(){var a,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPermissionState("Camera");case 2:return a=e.sent,n(te(a)),e.next=6,t.getPermissionState("Microphone");case 6:r=e.sent,n(ee(r));case 8:case"end":return e.stop()}}),e)})))),t.on("videoDevicesUpdated",Object(F.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:he(t,n,a);case 1:case"end":return e.stop()}}),e)})))),t.on("audioDevicesUpdated",Object(F.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pe(t,n,a);case 1:case"end":return e.stop()}}),e)})))),t.askDevicePermission(!0,!0).then((function(e){void 0!==e.audio&&(e.audio?(n(ee("Granted")),pe(t,n,a)):n(ee("Denied"))),void 0!==e.video&&(e.video?(n(te("Granted")),he(t,n,a)):n(te("Denied")))}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ve=n(400),ge=n(2),be=n(169),Se=n(420),Ee=n(413),Ie={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto",width:"12.5rem"},primaryText:{color:"#000000"}},Oe={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto"}},De=Object(j.D)({maxHeight:"21.875rem",overflow:"auto",paddingLeft:"1.125rem",paddingRight:"1.125rem"}),je=Object(j.D)({margin:"0.4375rem",fontSize:"1rem"}),Ce={childrenGap:"0.625rem",padding:"0.625rem"},ye=function(e){return r.createElement(r.Fragment,null,r.createElement(ve.a,{text:e.name,styles:Ie,size:ge.c.size32,presence:"Connected"===e.state?ge.b.online:ge.b.offline}),e.isScreenSharing&&r.createElement(be.a,{className:je,iconName:"ScreenCast"}))},we=function(e){return r.createElement(Se.a,{role:"menuitem",title:"More options",styles:Oe,menuIconProps:{iconName:"More"},menuProps:{items:e}})},xe=Object(l.b)((function(e){return{userId:e.sdk.userId,call:e.calls.call,callState:e.calls.callState,remoteParticipants:e.calls.remoteParticipants,screenShareStreams:e.streams.screenShareStreams,removeParticipant:function(t){e.calls.call&&t&&me(e.calls.call,t)}}}))((function(e){var t=e.screenShareStreams&&1===e.screenShareStreams.length,n=e.screenShareStreams[0],a=e.remoteParticipants.map((function(e){var a,r=!!t&&n.user===e;return{key:B.getId(e.identifier),name:null!==(a=e.displayName)&&void 0!==a?a:B.getId(e.identifier),participant:e,state:e.state,isScreenSharing:r}}));return a.push({key:"".concat(e.userId," (You)"),name:"".concat(e.userId," (You)"),participant:void 0,state:"Connected",isScreenSharing:!!t&&B.getId(n.user.identifier)===e.userId}),r.createElement(d.a,{className:De,tokens:Ce},function(e,t){return e.map((function(e,t){return r.createElement(Ee.a,{key:t,items:[e],role:"menubar",vertical:!1,onRenderOverflowButton:we,onRenderItem:ye})}))}(a,e.removeParticipant))})),Ne=n(408),Ae=n(394),ke=n(411),Le=Object(j.y)().palette,Pe={root:{height:"100%"}},Re={root:{marginBottom:"1.25rem"}},_e={childrenGap:"0.3125rem"},Ve={field:{color:Le.neutralSecondary,padding:0},root:{marginLeft:"1rem",marginRight:"1rem"},fieldGroup:{border:"none"}},Te=Object(j.D)({height:"4.3125rem"}),Me=Object(j.D)({fontSize:"1.375rem",fontWeight:600,width:"69px",float:"left",margin:"20px"}),ze=Object(j.D)({fontWeight:600,fontSize:"1rem",marginLeft:"1rem",marginRight:"1rem"}),We=Object(j.D)({fontWeight:600,fontSize:"0.875rem",height:"2.5rem",marginLeft:"1rem",marginRight:"1rem",width:"90%"}),Ge=Object(j.D)({marginRight:"0.5em"}),Fe=Object(j.D)({marginLeft:"1.25rem",width:"15.375rem"});!function(e){e.None="none",e.People="People",e.Settings="Settings"}(a||(a={}));var He=function(){document.getElementById("inputText").select(),document.execCommand("copy")},Ue=function(e){return i.a.createElement(d.a,{styles:Pe},i.a.createElement(d.a.Item,{className:Te},i.a.createElement("div",{className:Me},e.selectedPane)),i.a.createElement(d.a.Item,{styles:Pe},e.selectedPane===a.People&&i.a.createElement(d.a,{verticalAlign:"space-between",styles:Pe},i.a.createElement(xe,null),i.a.createElement(d.a,{styles:Re,tokens:_e},i.a.createElement(h.a,null),i.a.createElement("div",{className:ze},"Invite people to join"),i.a.createElement(Ne.a,{styles:Ve,id:"inputText",type:"text",value:"".concat(document.baseURI)}),i.a.createElement(Ae.a,{className:We,onClick:He},i.a.createElement(ke.a,{iconName:"Copy",className:Ge}),"Copy join info"))),e.selectedPane===a.Settings&&i.a.createElement("div",{className:Fe},i.a.createElement(M,{videoDeviceList:e.videoDeviceList,audioDeviceList:e.audioDeviceList,audioDeviceInfo:e.audioDeviceInfo,videoDeviceInfo:e.videoDeviceInfo,setVideoDeviceInfo:e.setVideoDeviceInfo,setAudioDeviceInfo:e.setAudioDeviceInfo}))))},Be=n(395),Ke=n(396),Ye=Object(j.y)().palette,qe={linkIsSelected:{padding:0,marginRight:0,height:"100%",color:Ye.themePrimary,selectors:{":hover":{color:Ye.themePrimary}}},link:{padding:0,marginRight:0,height:"3.75rem"},root:{width:"5.25rem",height:"3.75rem",display:"inline-block",verticalAlign:"top"}},Je=(Object(j.D)({display:"inline-block"}),Object(j.D)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2})),Qe=Object(j.D)(Je,{justifyContent:"center"}),Xe=Object(j.D)({display:"inline-block",padding:"0 1rem",height:"1.875rem"}),Ze=Object(j.D)({padding:"0 0.8125rem"}),$e={root:{color:Ye.neutralLight,width:"0.0625rem"}},et=n(43),tt=function e(){Object(et.a)(this,e)};tt.INCOMING="Incoming",tt.RINGING="Ringing",tt.CONNECTING="Connecting",tt.CONNECTED="Connected",tt.DEFAULT_IMG_WIDTH=200,tt.CROP_MEDIA="Crop",tt.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID="ConfigurationLocalVideoPreview",tt.LOCAL_VIDEO_PREVIEW_ID="LocalVideoPreview";var nt,at=Object(l.b)((function(e,t){return{actionable:e.calls.callState===tt.INCOMING||e.calls.callState===tt.RINGING||e.calls.callState===tt.CONNECTING||e.calls.callState===tt.CONNECTED,localVideoStream:e.streams.localVideoStream,mic:e.controls.mic,call:e.calls.call,shareScreen:e.controls.shareScreen,endCall:function(){e.calls.call&&le(e.calls.call,{forEveryone:!1}),t.endCallHandler()},videoDeviceInfo:e.devices.videoDeviceInfo,screenWidth:t.screenWidth,screenShareStreams:e.streams.screenShareStreams,localVideoRendererIsBusy:e.streams.localVideoRendererIsBusy,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission}}),(function(e){return{setLocalVideoStream:function(t){return e(ce(t))},setMic:function(t){return e(se(t))},setScreenShare:function(t){return e((n=t,function(){var e=Object(F.a)(G.a.mark((function e(t,a){var r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=a())&&void 0!==r.calls.call){e.next=4;break}return console.error("state or state.controls.shareScreen is null"),e.abrupt("return");case 4:if(e.prev=4,r.controls.shareScreen){e.next=10;break}return e.next=8,r.calls.call.startScreenSharing();case 8:e.next=12;break;case 10:return e.next=12,r.calls.call.stopScreenSharing();case 12:t(Z(n)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t,n){return e.apply(this,arguments)}}()));var n},isLocalScreenShareSupportedInBrowser:function(){return!B.isMobileSession()&&(/chrome/i.test(navigator.userAgent.toLowerCase())||/safari/i.test(navigator.userAgent.toLowerCase()))}}}))((function(e){var t,n=function(){if(e.localVideoStream)e.call.stopVideo(e.localVideoStream),e.setLocalVideoStream(void 0);else if(e.videoDeviceInfo){var t=new f.LocalVideoStream(e.videoDeviceInfo);e.setLocalVideoStream(t),e.call.startVideo(t)}};return Object(r.useEffect)((function(){e.call&&0===e.call.localVideoStreams.length&&e.localVideoStream&&e.call.startVideo(e.localVideoStream)}),[e.call,e.localVideoStream]),i.a.createElement(d.a,{id:"header",className:e.screenWidth>360?Je:Qe},i.a.createElement(u.a,{onKeyDownCapture:function(e){e.target.id===a.People&&39===e.keyCode&&e.preventDefault()},getTabId:function(e){return e},onLinkClick:function(t){var n,r;t&&(t.props.itemKey===a.Settings&&(n=e.selectedPane,r=e.setSelectedPane,n!==a.Settings?r(a.Settings):r(a.None)),t.props.itemKey===a.People&&function(e,t){e!==a.People?t(a.People):t(a.None)}(e.selectedPane,e.setSelectedPane))},styles:qe,initialSelectedKey:a.None,selectedKey:e.selectedPane},i.a.createElement(p.a,{itemKey:a.Settings,onRenderItemLink:function(){return i.a.createElement(Be.a,{outline:e.selectedPane!==a.Settings,size:"medium",className:Ze})}}),i.a.createElement(p.a,{itemKey:a.People,onRenderItemLink:function(){return i.a.createElement(Ke.a,{outline:e.selectedPane!==a.People,size:"medium",className:Ze})}}),i.a.createElement(p.a,{itemKey:a.None})),e.screenWidth>360&&i.a.createElement("div",{className:Xe},i.a.createElement(h.a,{styles:$e,vertical:!0})),i.a.createElement(L,{micActive:e.mic,onMicChange:function(){e.setMic(!e.mic)},cameraActive:void 0!==e.localVideoStream,onCameraChange:n,screenShareActive:e.shareScreen,activeScreenShareStream:null!==(t=e.screenShareStreams[0])&&void 0!==t?t:void 0,onScreenShareChange:function(){e.setScreenShare(!e.shareScreen)},onEndCallClick:function(){e.localVideo&&n(),e.endCall()},cameraPermission:e.cameraPermission,microphonePermission:e.microphonePermission,localVideoRendererIsBusy:e.localVideoRendererIsBusy,compressedMode:e.screenWidth<=360,isLocalScreenShareSupportedInBrowser:e.isLocalScreenShareSupportedInBrowser}))})),rt=Object(j.y)().palette,it=Object(j.D)({padding:"0.4375rem",display:"flex",alignItems:"center",justifyContent:"center",border:0,borderRight:"1px solid rgba(0,0,0,0.05)",borderBottom:"1px solid rgba(0,0,0,0.05)"}),ct=Object(j.D)({height:"100%",background:rt.neutralLighterAlt,display:"grid"}),ot=n(13),st=n(94),lt=Object(j.y)().palette,dt=Object(j.D)({backgroundColor:lt.neutralSecondary,bottom:"5%",height:"1.75rem",boxShadow:"0 0 1px 0 rgba(0,0,0,.16)",color:lt.neutralLighter,fontSize:"1.25rem",lineHeight:"1.0625rem",textAlign:"left",left:"2%",overflow:"hidden",position:"absolute",padding:"0.25rem",whiteSpace:"nowrap",maxWidth:"40%",borderRadius:4}),mt=Object(j.D)({position:"relative",height:"100%",width:"100%",background:"transparent"}),ut=Object(j.D)(mt,{width:"100%",height:"100%",transform:"rotateY(180deg)"}),pt=n(58),ht=n.n(pt),ft=function(e){var t,n=Object(r.useState)(!1),a=Object(s.a)(n,2),c=a[0],o=a[1],l={src:ht.a.toString(),imageFit:ot.b.contain,maximizeFrame:!0};return Object(r.useEffect)((function(){return Object(F.a)(G.a.mark((function n(){var a,r;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.stream){n.next=9;break}return a=new f.Renderer(e.stream),n.next=4,a.createView({scalingMode:"Crop"});case 4:t=n.sent,(r=document.getElementById(tt.LOCAL_VIDEO_PREVIEW_ID))&&0===r.childElementCount&&(r.appendChild(t.target),o(!0)),n.next=10;break;case 9:t&&(t.dispose(),o(!1));case 10:case"end":return n.stop()}}),n)})))(),function(){t&&(t.dispose(),o(!1))}}),[e.stream]),i.a.createElement("div",{className:mt},i.a.createElement("div",{style:{display:c?"block":"none"},className:ut,id:tt.LOCAL_VIDEO_PREVIEW_ID}),i.a.createElement(st.a,Object.assign({style:{display:c?"none":"block"}},l)),i.a.createElement(m.a,{className:dt},e.label))},vt=function(e){var t,n=e.stream?B.getStreamId(e.label,e.stream):"".concat(e.label," - no stream"),a=Object(r.useState)(!1),c=Object(s.a)(a,2),o=c[0],l=c[1],d={src:ht.a.toString(),imageFit:ot.b.contain,maximizeFrame:!0},u=e.stream,p=function(){var a=Object(F.a)(G.a.mark((function a(){var r,i;return G.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!((r=document.getElementById(n))&&e.stream&&e.stream.isAvailable)){a.next=10;break}return l(!0),i=new f.Renderer(e.stream),a.next=6,i.createView({scalingMode:"Crop"});case 6:t=a.sent,r&&0===r.childElementCount&&r.appendChild(t.target),a.next=12;break;case 10:l(!1),t&&t.dispose();case 12:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return Object(r.useEffect)((function(){u&&(u.on("availabilityChanged",p),u.isAvailable&&p())}),[u,p]),i.a.createElement("div",{className:mt},i.a.createElement("div",{style:{display:o?"block":"none"},className:mt,id:n}),i.a.createElement(st.a,Object.assign({style:{display:o?"none":"block"}},d)),i.a.createElement(m.a,{className:dt},e.label))},gt=Object(l.b)((function(e){return{userId:e.sdk.userId,remoteParticipants:e.calls.remoteParticipants,localVideoStream:e.streams.localVideoStream}}))((function(e){var t=Object(r.useState)(1),n=Object(s.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(1),l=Object(s.a)(o,2),d=l[0],m=l[1],u=i.a.useCallback((function(e,t){return Math.ceil((e.length+1)/t)}),[]),p=i.a.useCallback((function(e){return e&&e.length>0?Math.ceil(Math.sqrt(e.length+1)):1}),[])(e.remoteParticipants);p!==a&&c(p);var h=u(e.remoteParticipants,a);return h!==d&&m(h),i.a.createElement("div",{className:ct,style:{gridTemplateRows:"repeat(".concat(d,", minmax(0, 1fr))"),gridTemplateColumns:"repeat(".concat(a,", 1fr)")}},function(t,n){var a=t.map((function(e){var t;return i.a.createElement("div",{className:it},i.a.createElement(vt,{key:B.getId(e.identifier),stream:e.videoStreams[0],label:null!==(t=e.displayName)&&void 0!==t?t:B.getId(e.identifier)}))})),r=i.a.createElement("div",{key:n,className:it},i.a.createElement(ft,{label:n,stream:e.localVideoStream}));return a.unshift(r),a}(e.remoteParticipants,e.userId))})),bt=Object(j.y)().palette,St=Object(j.D)({padding:"0.5em",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:bt.neutralLighterAlt}),Et=Object(j.D)({display:"none",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:bt.neutralLighterAlt}),It=Object(j.D)({height:"100%",display:"flex",justifyContent:"center"}),Ot=n(415),Dt=n(36),jt=function(e){var t,n,a=Object(r.useState)(!0),c=Object(s.a)(a,2),o=c[0],l=c[1],d=e.activeScreenShareStream,m=function(){var e=Object(F.a)(G.a.mark((function e(){var t,a,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d||!d.stream){e.next=10;break}return t=d.stream,a=new f.Renderer(t),e.next=5,a.createView({scalingMode:"Fit"});case 5:n=e.sent,(r=document.getElementById("fullScreenStreamMediaId"))&&0===r.childElementCount&&(l(!1),r.appendChild(n.target)),e.next=11;break;case 10:n&&n.dispose();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){m()}),[d,m]);var u=null!==(t=e.activeScreenShareStream.user.displayName)&&void 0!==t?t:B.getId(e.activeScreenShareStream.user.identifier);return i.a.createElement(i.a.Fragment,null,o&&i.a.createElement("div",{className:It},i.a.createElement(Ot.a,{label:"Loading ".concat(u,"'s screen"),size:Dt.a.xSmall})),i.a.createElement("div",{id:"fullScreenStreamMediaId",className:o?Et:St}))},Ct=Object(j.y)().palette,yt={root:{width:"100%"}},wt={root:{height:"100%",minHeight:"9.375rem",width:"100%"}},xt={root:{width:"17.875rem"}},Nt={root:{border:"solid 1px ".concat(Ct.neutralLighterAlt),height:"100%",display:"none"}},At={root:{border:"solid 1px ".concat(Ct.neutralLighterAlt),height:"calc(100% - 3px)",display:"initial"}},kt=Object(j.D)({height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Lt=Object(l.b)((function(e,t){return{userId:e.sdk.userId||t.userId,callAgent:e.calls.callAgent,group:e.calls.group,screenWidth:t.screenWidth,call:e.calls.call,shareScreen:e.controls.shareScreen,mic:e.controls.mic,groupCallEndReason:e.calls.groupCallEndReason,isGroup:function(){return e.calls.call&&!e.calls.call.isIncoming&&!!e.calls.group},joinGroup:function(){e.calls.callAgent&&de(e.calls.callAgent,{groupId:e.calls.group},{audioOptions:{muted:!e.controls.mic}})},remoteParticipants:e.calls.remoteParticipants,streams:e.streams.streams,callState:e.calls.callState,localVideo:e.controls.localVideo,localVideoStream:e.streams.localVideoStream,screenShareStreams:e.streams.screenShareStreams,videoDeviceInfo:e.devices.videoDeviceInfo,audioDeviceInfo:e.devices.audioDeviceInfo,videoDeviceList:e.devices.videoDeviceList,audioDeviceList:e.devices.audioDeviceList,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission}}),(function(e){return{mute:function(){return e(se(!1))},setAudioDeviceInfo:function(t){return e(ne(t))},setVideoDeviceInfo:function(t){e(ae(t))},setLocalVideoStream:function(t){return e(ce(t))}}}))((function(e){var t=Object(r.useState)(a.None),n=Object(s.a)(t,2),c=n[0],o=n[1],l=e.screenShareStreams&&1===e.screenShareStreams.length,u=e.callAgent,p=e.call,h=e.groupIdPromise,f=e.joinGroup;return Object(r.useEffect)((function(){u&&!p&&h.then((function(e){f(),document.title="Group ID ".concat(e),console.log("Group ID is "+e)}))}),[u,p,h,f]),i.a.createElement(d.a,{horizontalAlign:"center",verticalAlign:"center",styles:wt},i.a.createElement(d.a.Item,{styles:yt},i.a.createElement(at,{selectedPane:c,setSelectedPane:o,endCallHandler:e.endCallHandler,screenWidth:e.screenWidth})),i.a.createElement(d.a.Item,{styles:wt},e.shareScreen?i.a.createElement("div",{className:kt},i.a.createElement(m.a,null,"Your screen is being shared")):e.callState===tt.CONNECTED&&i.a.createElement(d.a,{horizontal:!0,styles:wt},i.a.createElement(d.a.Item,{grow:!0,styles:l?At:Nt},l&&i.a.createElement(jt,{activeScreenShareStream:e.screenShareStreams[0]})),i.a.createElement(d.a.Item,{grow:!0,styles:l?Nt:At},i.a.createElement(gt,null)),c!==a.None&&i.a.createElement(d.a.Item,{disableShrink:!0,styles:xt},i.a.createElement(Ue,Object.assign({},e,{selectedPane:c,setSelectedPane:o}))))))})),Pt=n(52),Rt=n(8),_t={deviceManager:void 0,audioDeviceInfo:void 0,videoDeviceInfo:void 0,audioDeviceList:[],videoDeviceList:[],cameraPermission:void 0,microphonePermission:void 0},Vt={localVideoRendererIsBusy:!1,localVideoStream:void 0,streams:[],screenShareStreams:[]},Tt={mic:!1,localVideo:!1,shareScreen:!1},Mt={callAgent:void 0,call:void 0,callState:"None",incomingCallEndReason:void 0,groupCallEndReason:void 0,remoteParticipants:[],group:""},zt=Object(Pt.c)({calls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CALL_AGENT":return Object(Rt.a)(Object(Rt.a)({},e),{},{callAgent:t.callAgent});case"CALL_ADDED":return Object(Rt.a)(Object(Rt.a)({},e),{},{call:t.call});case"CALL_REMOVED":return Object(Rt.a)(Object(Rt.a)({},e),{},{call:void 0,remoteParticipants:[],incomingCallEndReason:t.incomingCallEndReason,groupCallEndReason:t.groupCallEndReason});case"SET_CALL_STATE":return Object(Rt.a)(Object(Rt.a)({},e),{},{callState:t.callState});case"SET_PARTICIPANTS":return Object(Rt.a)(Object(Rt.a)({},e),{},{remoteParticipants:t.remoteParticipants});case"SET_GROUP":return Object(Rt.a)(Object(Rt.a)({},e),{},{group:t.group});default:return e}},devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DEVICE_MANAGER":return Object(Rt.a)(Object(Rt.a)({},e),{},{deviceManager:t.deviceManager});case"SET_VIDEO_DEVICE_INFO":return Object(Rt.a)(Object(Rt.a)({},e),{},{videoDeviceInfo:t.videoDeviceInfo});case"SET_AUDIO_DEVICE_INFO":return Object(Rt.a)(Object(Rt.a)({},e),{},{audioDeviceInfo:t.audioDeviceInfo});case"SET_VIDEO_DEVICE_LIST":return Object(Rt.a)(Object(Rt.a)({},e),{},{videoDeviceList:t.videoDeviceList});case"SET_AUDIO_DEVICE_LIST":return Object(Rt.a)(Object(Rt.a)({},e),{},{audioDeviceList:t.audioDeviceList});case"SET_CAMERA_PERMISSION":return Object(Rt.a)(Object(Rt.a)({},e),{},{cameraPermission:t.cameraPermission});case"SET_MICROPHONE_PERMISSION":return Object(Rt.a)(Object(Rt.a)({},e),{},{microphonePermission:t.microphonePermission});default:return e}},streams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_VIDEO_DEVICE_INFO":return e.localVideoStream&&t.videoDeviceInfo?Object(Rt.a)(Object(Rt.a)({},e),{},{localVideoStream:new f.LocalVideoStream(t.videoDeviceInfo)}):e;case"SET_LOCAL_STREAM":return Object(Rt.a)(Object(Rt.a)({},e),{},{localVideoStream:t.localVideoStream});case"ADD_SCREENSHARE_STREAM":var n={stream:t.stream,user:t.user};return Object(Rt.a)(Object(Rt.a)({},e),{},{screenShareStreams:[].concat(Object(z.a)(e.screenShareStreams),[n])});case"REMOVE_SCREENSHARE_STREAM":var a=e.screenShareStreams.filter((function(e){return e.stream!==t.stream&&e.user!==t.user}));return Object(Rt.a)(Object(Rt.a)({},e),{},{screenShareStreams:a});case"RESET_STREAMS":return Vt;default:return e}},controls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MIC":return Object(Rt.a)(Object(Rt.a)({},e),{},{mic:t.mic});case"SET_SHARE_SCREEN":return Object(Rt.a)(Object(Rt.a)({},e),{},{shareScreen:t.shareScreen});case"RESET_CONTROLS":return Tt;default:return e}},sdk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERID":return Object(Rt.a)(Object(Rt.a)({},e),{},{userId:t.userId});default:return e}}}),Wt=n(180),Gt=n(190),Ft=n(397),Ht={childrenGap:"0.25rem"},Ut={childrenGap:"0.75rem"},Bt={childrenGap:"1.5rem"},Kt=Object(j.D)({width:"20.625rem"}),Yt=Object(j.D)({fontSize:"1.375rem",fontWeight:600}),qt=Object(j.D)({fontWeight:600,height:"2.5rem",width:"9.875rem",fontSize:"0.875rem",padding:0}),Jt=Object(j.D)({marginRight:"0.375rem",fontSize:"1.375rem"}),Qt=Object(j.D)({color:"rgb(0,0,0)",fontSize:"0.875 rem"}),Xt=function(e){return i.a.createElement(d.a,{verticalAlign:"center",tokens:Ht,className:Kt},i.a.createElement(d.a,{tokens:Bt},i.a.createElement("div",{className:Yt},"You left the call"),i.a.createElement(d.a,{horizontal:!0,tokens:Ut},i.a.createElement(Ae.a,{className:qt,onClick:e.rejoinHandler},i.a.createElement(Ft.a,{className:Jt,size:"medium"}),"Rejoin call"),i.a.createElement(Gt.a,{className:qt,onClick:e.homeHandler},"Go to homepage")),i.a.createElement("div",{className:Qt},i.a.createElement("a",{href:"https://github.com/Azure/Communication/issues"},"Give Feedback"),"\xa0on this sample app on Github")))},Zt=n(181),$t=n.n(Zt),en=Object(j.y)().palette,tn=Object(j.D)({width:"27.25rem",height:"20.125rem",selectors:{"@media (max-width: 67.1875rem)":{display:"none"}}}),nn={childrenGap:"3.4375rem"},an={childrenGap:"2.625rem"},rn=(Object(j.D)({listStyleType:"none",fontSize:"0.875rem"}),Object(j.D)({marginRight:"0.4375rem",color:en.themePrimary}),Object(j.D)({fontWeight:600,fontSize:"2.25rem",maxWidth:"23.188rem"})),cn=Object(j.D)({marginRight:"0.375rem",fontSize:"1.375rem"}),on=Object(j.D)({fontWeight:600,fontSize:"0.875rem",width:"7.75rem",height:"2.5rem",borderRadius:3,padding:"0.625rem"}),sn=Object(j.D)({selectors:{"@media (max-width: 53.4375rem)":{padding:"0.625rem"}}}),ln={image:{height:"100%",width:"100%"},root:{}},dn=function(e){var t={src:$t.a.toString()};return i.a.createElement(d.a,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",tokens:nn},i.a.createElement(d.a,{className:sn,tokens:an},i.a.createElement("div",{className:rn},"The Family Video Call"),i.a.createElement(Ae.a,{className:on,onClick:e.startCallHandler},i.a.createElement(Ft.a,{className:cn,size:"medium"}),"Let's go")),i.a.createElement(st.a,Object.assign({alt:"Welcome to the ACS Calling sample app",className:tn,styles:ln},t)))},mn=n(416),un=Object(j.y)().palette,pn={root:{marginBottom:0}},hn={root:{width:"10rem",height:"10.5rem"}},fn={childrenGap:"0.625rem",padding:"0.625rem"},vn=Object(j.D)({maxWidth:"25rem",minWidth:"12.5rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"12.5rem",background:un.neutralLighter,color:un.neutralPrimaryAlt}),gn=Object(j.D)({height:"2.8125rem",width:"100%",backgroundColor:un.neutralQuaternaryAlt}),bn=Object(j.D)({width:"100%",height:"100%",maxHeight:"15.9375rem",transform:"rotateY(180deg)"}),Sn=function(e){var t={src:ht.a.toString(),imageFit:ot.b.cover,maximizeFrame:!0};return Object(r.useEffect)((function(){return Object(F.a)(G.a.mark((function t(){var n,a;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.localVideoStream){t.next=7;break}return n=new f.Renderer(e.localVideoStream),t.next=4,n.createView({scalingMode:"Crop"});case 4:nt=t.sent,(a=document.getElementById(tt.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID))&&0===a.childElementCount&&a.appendChild(nt.target);case 7:case"end":return t.stop()}}),t)})))(),function(){nt&&nt.dispose()}}),[e.localVideoStream]),i.a.createElement(d.a,{className:vn},i.a.createElement(d.a,{horizontalAlign:"center",verticalAlign:"center",id:tt.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID,className:bn},!e.localVideoStream&&i.a.createElement(st.a,Object.assign({styles:hn},t))),i.a.createElement(d.a,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",tokens:fn,className:gn},i.a.createElement(g.a,{size:"medium"}),i.a.createElement(mn.a,{onKeyDownCapture:function(e){},styles:pn,disabled:!e.videoDeviceInfo,onChange:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new f.LocalVideoStream(e.videoDeviceInfo);e.setLocalVideoStream(n?a:void 0)}}),i.a.createElement(S.a,{size:"medium"}),i.a.createElement(mn.a,{styles:pn,disabled:!e.audioDeviceInfo,onChange:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setMic(n)}})))},En={childrenGap:"3rem"},In=Object(j.D)({marginRight:"0.375rem",fontSize:"1.375rem"}),On=Object(j.D)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"2.125rem",maxWidth:"18.75rem",minWidth:"12.5rem"}),Dn=Object(j.D)({maxWidth:"46.875rem",width:"100%",height:"100%",selectors:{"@media (max-width: 750px)":{padding:"0.625rem",height:"100%"}}}),jn=Object(j.D)({width:"100%",maxWidth:"18.75rem"}),Cn=Object(j.D)({height:"100%",width:"100%"}),yn=Object(j.D)({height:"100%",width:"100%",justifyContent:"space-evenly"}),wn=(Object(j.D)({minWidth:"12.5rem"}),Object(j.D)({boxSizing:"border-box",height:"2.5rem",width:"18.75rem",border:"0.125rem solid #CCCCCC",borderRadius:"0.188rem",backgroundColor:"#FFFFFF"})),xn=Object(j.D)({fontSize:"0.875rem",lineHeight:"1.5rem"}),Nn=Object(j.D)({boxSizing:"border-box",height:"2.5rem",width:"18.75rem",border:"0.125rem solid #e81123",borderRadius:"0.188rem",backgroundColor:"#FFFFFF",fontSize:"0.875rem"}),An=Object(j.D)({fontSize:"0.875rem",fontWeight:600,color:"rgb(50, 49, 48)",boxSizing:"border-box",boxShadow:"none",margin:0,display:"inline-block",padding:"5px 0px",overflowWrap:"break-word"}),kn=Object(j.D)({width:"18.75rem",backgroundColor:"#FFFFFF",marginTop:"0.188rem",marginBottom:"0.188rem",marginLeft:"0.188rem",color:"#e81123",fontSize:".7375rem",fontWeight:"400"}),Ln={root:{height:"auto"}},Pn=function(e){return i.a.createElement("div",null,i.a.createElement("div",{className:An},"Name"),i.a.createElement(Ne.a,{autoComplete:"off",inputClassName:xn,ariaLabel:"Choose your name",borderless:!0,className:e.isEmpty?Nn:wn,onChange:function(t){e.setName(t.target.value),t.target.value?e.setEmptyWarning(!1):e.setEmptyWarning(!0)},id:"name",placeholder:"Enter your name",defaultValue:e.name,styles:Ln}),e.isEmpty&&i.a.createElement("div",{role:"alert",className:kn}," ","Name cannot be empty"," "))},Rn=Object(l.b)((function(e,t){return{deviceManager:e.devices.deviceManager,callAgent:e.calls.callAgent,userId:e.sdk.userId||t.userId,group:e.calls.group,mic:e.controls.mic,screenWidth:t.screenWidth,localVideoStream:e.streams.localVideoStream,audioDeviceInfo:e.devices.audioDeviceInfo,videoDeviceInfo:e.devices.videoDeviceInfo,videoDeviceList:e.devices.videoDeviceList,audioDeviceList:e.devices.audioDeviceList,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission}}),(function(e){return{setLocalVideoStream:function(t){return e(ce(t))},setMic:function(t){return e(X(t))},setAudioDeviceInfo:function(t){return e(ne(t))},setVideoDeviceInfo:function(t){return e(ae(t))},initCallClient:function(t,n,a){return e(function(e,t,n){return function(){var n=Object(F.a)(G.a.mark((function n(a,r){var i,c,o,s,l,d,m;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,B.getTokenForUser(e);case 3:if(i=n.sent,c={},o=i.value.token,!B.isOnIphoneAndNotSafari()){n.next=9;break}return t(),n.abrupt("return");case 9:n.prev=9,s=new f.CallClient(c),n.next=17;break;case 13:return n.prev=13,n.t0=n.catch(9),t(),n.abrupt("return");case 17:if(s){n.next=19;break}return n.abrupt("return");case 19:return l=new H.a(o),n.next=22,s.createCallAgent(l);case 22:if(void 0!==(d=n.sent)){n.next=25;break}return n.abrupt("return");case 25:return d.updateDisplayName(e),n.next=28,s.getDeviceManager();case 28:m=n.sent,a($(m)),a(K(d)),fe(m,a,r),d.on("callsUpdated",(function(e){e.added.forEach((function(e){if(r().calls.call&&e.isIncoming)e.reject();else{a(Y(e)),e.on("callStateChanged",(function(){a(J(e.state))})),e.on("isScreenSharingOnChanged",(function(){a(Z(e.isScreenSharingOn))})),e.on("remoteParticipantsUpdated",(function(t){t.added.forEach((function(t){console.log("participantAdded",t),ue(t,e,a,r),a(Q(Object(z.a)(e.remoteParticipants.values())))})),t.removed.length>0&&(console.log("participantRemoved"),a(Q(Object(z.a)(e.remoteParticipants.values()))))}));var t=Object(z.a)(e.remoteParticipants.values());t.forEach((function(t){return ue(t,e,a,r)})),a(Q(t)),a(J(e.state))}})),e.removed.forEach((function(e){console.log("callRemoved",e);var t=r();t.calls.call&&t.calls.call===e&&(a(q(e,t.calls.group)),a({type:"RESET_CONTROLS"}),a({type:"RESET_STREAMS"}))}))})),n.next=38;break;case 35:n.prev=35,n.t1=n.catch(0),console.error(n.t1);case 38:case"end":return n.stop()}}),n,null,[[0,35],[9,13]])})));return function(e,t){return n.apply(this,arguments)}}()}(t,n))},setUserId:function(t){return e(function(e){return{type:"SET_USERID",userId:e}}(t))},setGroup:function(t){return e(function(e){return{type:"SET_GROUP",group:e}}(t))},updateDevices:function(){return e(function(){var e=Object(F.a)(G.a.mark((function e(t,n){var a,r,i,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),null!=(r=a.devices.deviceManager)){e.next=5;break}return console.error("no device manager available"),e.abrupt("return");case 5:return e.next=7,r.getCameraList();case 7:return i=e.sent,t(ie(i)),e.next=11,r.getMicrophoneList();case 11:c=e.sent,t(re(c));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))((function(e){var t=Object(r.useState)(e.userId),n=Object(s.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)(!1),l=Object(s.a)(o,2),m=l[0],u=l[1],p=e.userId,h=e.groupIdPromise,f=e.setUserId,v=e.initCallClient,g=e.setGroup,b=e.unsupportedStateHandler,S=e.endCallHandler;return Object(r.useEffect)((function(){f(p),v(p,b,S),h.then((function(e){g(e),console.log("Group ID is "+e)}))}),[p,h,f,v,g,b,S]),i.a.createElement(d.a,{className:Dn,horizontalAlign:"center",verticalAlign:"center"},e.deviceManager?i.a.createElement(d.a,{className:e.screenWidth>750?Cn:yn,horizontal:e.screenWidth>750,horizontalAlign:"center",verticalAlign:"center",tokens:e.screenWidth>750?En:void 0},i.a.createElement(Sn,{setMic:e.setMic,setLocalVideoStream:e.setLocalVideoStream,videoDeviceInfo:e.videoDeviceInfo,audioDeviceInfo:e.audioDeviceInfo,localVideoStream:e.localVideoStream}),i.a.createElement(d.a,{className:jn},i.a.createElement(Pn,{setName:c,name:a,setEmptyWarning:u,isEmpty:m}),i.a.createElement("div",null,i.a.createElement(M,{videoDeviceList:e.videoDeviceList,audioDeviceList:e.audioDeviceList,audioDeviceInfo:e.audioDeviceInfo,videoDeviceInfo:e.videoDeviceInfo,setVideoDeviceInfo:e.setVideoDeviceInfo,setAudioDeviceInfo:e.setAudioDeviceInfo})),i.a.createElement("div",null,i.a.createElement(Ae.a,{className:On,onClick:function(){a?(u(!1),e.setUserId(a),e.callAgent.updateDisplayName(a),e.startCallHandler()):u(!0)}},i.a.createElement(Ft.a,{className:In,size:"medium"}),"Start call")))):i.a.createElement(Ot.a,{label:"Initializing call client...",ariaLive:"assertive",labelPosition:"top"}))})),_n=n(399),Vn=n(341).dependencies["@azure/communication-calling"],Tn="Last Updated ".concat(B.getBuildTime()," with @azure/communication-calling:").concat(Vn);Object(j.B)({}),Object(_n.a)();var Mn=Object(Pt.d)(zt,Object(Pt.a)(Wt.a));window.setTimeout((function(){try{console.log("ACS sample group calling app: ".concat(Tn))}catch(e){}}),0);var zn=function(){var e=Object(r.useState)("home"),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(0),o=Object(s.a)(c,2),d=o[0],m=o[1];Object(r.useEffect)((function(){var e=function(){var e="undefined"!==typeof window?window.innerWidth:0;m(e)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var u=function(){return"user"+Math.ceil(1e3*Math.random())};return(B.isMobileSession()||B.isSmallScreen())&&console.log("ACS Calling sample: This is experimental behaviour"),i.a.createElement(l.a,{store:Mn},"home"===n?i.a.createElement(dn,{startCallHandler:function(){a("configuration")}}):"configuration"===n?i.a.createElement(Rn,{startCallHandler:function(){return a("call")},unsupportedStateHandler:function(){return a("error")},endCallHandler:function(){return a("endCall")},groupIdPromise:B.getGroupID(),userId:u(),screenWidth:d}):"call"===n?i.a.createElement(Lt,{endCallHandler:function(){return a("endCall")},groupIdPromise:B.getGroupID(),userId:u(),screenWidth:d}):"endCall"===n?i.a.createElement(Xt,{rejoinHandler:function(){a("call")},homeHandler:function(){window.location.href=window.location.href.split("?")[0]}}):(window.document.title="Unsupported browser",i.a.createElement(i.a.Fragment,null,i.a.createElement("a",{href:"https://aka.ms/ACS-CallingSupport#calling-client-library-browser-support"},"Learn more"),"\xa0about browsers and platforms supported by the web calling sdk")))},Wn=n(398),Gn=n(182),Fn=n(187),Hn=n(188),Un={componentStyles:{SvgIcon:Gn.a},componentVariables:{SvgIcon:Fn.a},siteVariables:Hn};o.a.render(i.a.createElement(Wn.a,{theme:Un,className:"wrapper"},i.a.createElement(zn,null)),document.getElementById("root"))},58:function(e,t,n){e.exports=n.p+"static/media/staticmedia.19456955.svg"}},[[209,1,2]]]);
//# sourceMappingURL=main.9c2fc998.chunk.js.map